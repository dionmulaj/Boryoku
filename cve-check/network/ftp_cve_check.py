PORTS = [21]

CVE_MAPPINGS = {
    "ProFTPD 1.3.5": "CVE-2015-3306",
    "ProFTPD 1.3.3c": "CVE-2010-3867",
    "vsftpd 2.3.4": "CVE-2011-2523",
    "Pure-FTPd 1.0.36": "CVE-2015-9261",
    "FileZilla 0.9.41": "CVE-2014-3566",
    "ProFTPD 1.3.2": "CVE-2009-3639",
    "vsftpd 2.0.7": "CVE-2008-2375",
    "FileZilla 3.7.3": "CVE-2013-3774",
    "Pure-FTPd 1.0.21": "CVE-2008-4242",
    "ProFTPD 1.2.9": "CVE-2006-5815",
    "ProFTPD 1.3.1": "CVE-2008-7265",
    "vsftpd 2.1.0": "CVE-2009-3053",
    "FileZilla 3.10.0": "CVE-2015-5600",
    "Pure-FTPd 1.0.42": "CVE-2018-20721",
    "ProFTPD 1.3.4a": "CVE-2011-4130",
    "vsftpd 2.2.2": "CVE-2012-4251",
    "FileZilla 3.5.3": "CVE-2012-3452",
    "Pure-FTPd 1.0.22": "CVE-2010-4221",
    "ProFTPD 1.3.0": "CVE-2007-2165"
}

def run(host, results):
    from ftplib import FTP
    try:
        ftp = FTP()
        ftp.connect(host, 21, timeout=5)
        banner = ftp.getwelcome()
        cve = None
        for key, val in CVE_MAPPINGS.items():
            if key in banner:
                cve = val
                break
            if cve:
                results[host].setdefault("CVE-CHECK", []).append(f"Potential CVE detected: {cve} via FTP banner: {banner}")
        ftp.quit()
    except Exception:
        pass  
