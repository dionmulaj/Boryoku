PORTS = [25]

CVE_MAPPINGS = {
    "Exim 4.87": "CVE-2016-1531",
    "Exim 4.92": "CVE-2019-15846",
    "Exim 4.91": "CVE-2019-13917",
    "Exim 4.86": "CVE-2016-1531",
    "Exim 4.82": "CVE-2014-2957",
    "Postfix 2.9.6": "CVE-2014-3566",
    "Postfix 3.3.0": "CVE-2017-1000363",
    "Postfix 2.10.0": "CVE-2014-9730",
    "Postfix 2.5.5": "CVE-2009-2937",
    "Postfix 2.3.3": "CVE-2006-3449",
    "Sendmail 8.13.8": "CVE-2006-0058",
    "Sendmail 8.12.11": "CVE-2004-0095",
    "Sendmail 8.14.4": "CVE-2011-3447",
    "Sendmail 8.13.1": "CVE-2005-0531",
    "qmail 1.03": "CVE-2005-1513",
    "qmail 1.02": "CVE-2004-0983",
    "Microsoft Exchange 2013": "CVE-2016-0026",
    "Microsoft Exchange 2016": "CVE-2020-16875",
    "Lotus Domino 8.5": "CVE-2011-0913",
    "Lotus Domino 9.0": "CVE-2014-0904"
}

def run(host, results):
    import socket
    try:
        s = socket.socket()
        s.settimeout(5)
        s.connect((host, 25))
        banner = s.recv(1024).decode(errors='ignore')
        cve = None
        for key, val in CVE_MAPPINGS.items():
            if key in banner:
                cve = val
                break
            if cve:
                results[host].setdefault("CVE-CHECK", []).append(f"Potential CVE detected: {cve} via SMTP banner: {banner.strip()}")
        s.close()
    except Exception:
        pass  
